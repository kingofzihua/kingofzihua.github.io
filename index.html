<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    kingofzihua
</title>
<link rel="shortcut icon" href="https://blog.kingofzihua.top/favicon.ico?v=1577771342871">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://blog.kingofzihua.top/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://blog.kingofzihua.top/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://blog.kingofzihua.top">
                <img class="avatar" src="https://blog.kingofzihua.top/images/avatar.png?v=1577771342871" alt="">
            </a>
            <div class="site-title">
                <h1>
                    kingofzihua
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    首页
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    归档
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    标签
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    关于
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-container main-container">
                <div id="content" class="main-container-left">
                    
        
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://blog.kingofzihua.top/post/laravel-xiang-mu-wei-jing-tai-fen-ye-chu-li">
                        Laravel 项目 伪静态分页处理
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2019-12-31</time>
                    
                        <a href="https://blog.kingofzihua.top/tag/eKiukqYwE" class="post-tag i-tag
                            i-tag-other_4">
            #伪静态
        </a>
                        
                        <a href="https://blog.kingofzihua.top/tag/Y4NpI8nJt" class="post-tag i-tag
                            i-tag-success">
            #laravel
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                    <div class="post-content-abstract">
                                        <blockquote>
<p>手上有个Laravel 的项目，要求做伪静态处理，项目中使用了 Laravel 自带的分页组件，分页组件分页会在你的url 用 query 的方式做页码的传递，达不到伪静态的要求。</p>
</blockquote>

                                    </div>
                                    
                                            <a class="btn btn-text" href="https://blog.kingofzihua.top/post/laravel-xiang-mu-wei-jing-tai-fen-ye-chu-li">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://blog.kingofzihua.top/post/wen-ben-chu-li-san-jian-ke-zhi-awk">
                        文本处理三剑客之awk
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2019-10-31</time>
                    
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                    <div class="post-content-abstract">
                                        <blockquote>
<p>AWK是一个优良的文本处理工具，Linux及Unix环境中现有的功能最强大的数据处理引擎之一。AWK 提供了极其强大的功能：可以进行样式装入、流控制、数学运算符、进程控制语句甚至于内置的变量和函数。它具备了一个完整的语言所应具有的几乎所有精美特性。              --- 百度百科</p>
</blockquote>

                                    </div>
                                    
                                            <a class="btn btn-text" href="https://blog.kingofzihua.top/post/wen-ben-chu-li-san-jian-ke-zhi-awk">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://blog.kingofzihua.top/post/elasticsearch-query-dsl-compound-queries">
                        Elasticsearch Query DSL - 复合查询
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2019-09-16</time>
                    
                </div>
                <div class="post-article">
                    
                        <a href="https://blog.kingofzihua.top/post/elasticsearch-query-dsl-compound-queries" class="post-feature-image" style="background-image:url(https://blog.kingofzihua.top/post-images/elasticsearch-query-dsl-compound-queries.jpg) ">
                        </a>
                        
                            <div class="post-content">
                                
                                    <div class="post-content-abstract">
                                        <blockquote>
<p>复合查询包括其他复合查询或叶查询，可以组合其结果和分数，更改其行为，或者从查询切换到筛选上下文。</p>
</blockquote>

                                    </div>
                                    
                                            <a class="btn btn-text" href="https://blog.kingofzihua.top/post/elasticsearch-query-dsl-compound-queries">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://blog.kingofzihua.top/post/elasticsearch-query-dsl-term-level-querie">
                        Elasticsearch Query DSL - 术语查询 
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2019-09-12</time>
                    
                        <a href="https://blog.kingofzihua.top/tag/n9VRPxrjY" class="post-tag i-tag
                            i-tag-other_1">
            #elasticsearch
        </a>
                        
                </div>
                <div class="post-article">
                    
                        <a href="https://blog.kingofzihua.top/post/elasticsearch-query-dsl-term-level-querie" class="post-feature-image" style="background-image:url(https://blog.kingofzihua.top/post-images/elasticsearch-query-dsl-term-level-querie.jpg) ">
                        </a>
                        
                            <div class="post-content">
                                
                                    <div class="post-content-abstract">
                                        <blockquote>
<p>Term Level（术语） 查询操作的是存储在反向索引（倒排索引）中的准确词根，这些查询通常用于结构化数据，如数字、日期和枚举，而不是全文字段，无需进行分析（分词），Term Level查询类似于关系型数据库的（where条件过滤）。</p>
</blockquote>

                                    </div>
                                    
                                            <a class="btn btn-text" href="https://blog.kingofzihua.top/post/elasticsearch-query-dsl-term-level-querie">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://blog.kingofzihua.top/post/elasticsearch-mapping-ying-she">
                        Elasticsearch Mapping (映射)
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2019-09-05</time>
                    
                        <a href="https://blog.kingofzihua.top/tag/rxaUEiO86" class="post-tag i-tag
                            i-tag-other_2">
            #mapping
        </a>
                        
                        <a href="https://blog.kingofzihua.top/tag/n9VRPxrjY" class="post-tag i-tag
                            i-tag-error">
            #elasticsearch
        </a>
                        
                </div>
                <div class="post-article">
                    
                        <a href="https://blog.kingofzihua.top/post/elasticsearch-mapping-ying-she" class="post-feature-image" style="background-image:url(https://blog.kingofzihua.top/post-images/elasticsearch-mapping-ying-she.jpg) ">
                        </a>
                        
                            <div class="post-content">
                                
                                    <div class="post-content-abstract">
                                        <blockquote>
<p>为了能够将时间域视为时间，数字域视为数字，字符串域视为全文或精确值字符串， Elasticsearch 需要知道每个域中数据的类型。这个信息包含在映射中。</p>
</blockquote>

                                    </div>
                                    
                                            <a class="btn btn-text" href="https://blog.kingofzihua.top/post/elasticsearch-mapping-ying-she">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://blog.kingofzihua.top/post/elasticsearch-analyzer-fen-ci-qi">
                        Elasticsearch Analyzer (分词器)
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2019-09-04</time>
                    
                        <a href="https://blog.kingofzihua.top/tag/n9VRPxrjY" class="post-tag i-tag
                            i-tag-warning">
            #elasticsearch
        </a>
                        
                </div>
                <div class="post-article">
                    
                        <a href="https://blog.kingofzihua.top/post/elasticsearch-analyzer-fen-ci-qi" class="post-feature-image" style="background-image:url(https://blog.kingofzihua.top/post-images/elasticsearch-analyzer-fen-ci-qi.jpg) ">
                        </a>
                        
                            <div class="post-content">
                                
                                    <div class="post-content-abstract">
                                        <blockquote>
<p>在Elasticsearch中，索引分析模块是可以通过注册分词器（analyzer）来进行配置。分词器的作用是当一个文档被索引的时候分词器从文档中提取出若干词元(token)来支持索引的存储和搜索。</p>
</blockquote>

                                    </div>
                                    
                                            <a class="btn btn-text" href="https://blog.kingofzihua.top/post/elasticsearch-analyzer-fen-ci-qi">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://blog.kingofzihua.top/post/elasticsearch-rest-api">
                        Elasticsearch REST API
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2019-09-03</time>
                    
                        <a href="https://blog.kingofzihua.top/tag/n9VRPxrjY" class="post-tag i-tag
                            i-tag-info">
            #elasticsearch
        </a>
                        
                </div>
                <div class="post-article">
                    
                        <a href="https://blog.kingofzihua.top/post/elasticsearch-rest-api" class="post-feature-image" style="background-image:url(https://blog.kingofzihua.top/post-images/elasticsearch-rest-api.png) ">
                        </a>
                        
                            <div class="post-content">
                                
                                    <div class="post-content-abstract">
                                        <blockquote>
<p>为了方便其他语言的整合Elasticsearch为开发者提供了一套基于Http协议的Restful接口，只需要构造rest请求并解析请求返回的json即可实现访问Elasticsearch服务器。Elasticsearch的API接口功能丰富，包含集群、监控、部署管理等，也包含常用的文档、索引操作。</p>
</blockquote>

                                    </div>
                                    
                                            <a class="btn btn-text" href="https://blog.kingofzihua.top/post/elasticsearch-rest-api">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://blog.kingofzihua.top/post/elasticsearch-ji-ben-gai-nian">
                        Elasticsearch 基本概念
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2019-09-02</time>
                    
                        <a href="https://blog.kingofzihua.top/tag/n9VRPxrjY" class="post-tag i-tag
                            i-tag-info">
            #elasticsearch
        </a>
                        
                </div>
                <div class="post-article">
                    
                        <a href="https://blog.kingofzihua.top/post/elasticsearch-ji-ben-gai-nian" class="post-feature-image" style="background-image:url(https://blog.kingofzihua.top/post-images/elasticsearch-ji-ben-gai-nian.jpeg) ">
                        </a>
                        
                            <div class="post-content">
                                
                                    <div class="post-content-abstract">
                                        <blockquote>
<p>Elasticsearch 是一个分布式的搜索和分析引擎，可以用于全文检索、结构化检索和分析，并能将这三者结合起来。Elasticsearch 基于 Lucene 开发，是 Lucene 的封装，提供了 REST API 的操作接口，开箱即用。现在是使用最广的开源搜索引擎之一，Wikipedia、Stack Overflow、GitHub 等都基于 Elasticsearch 来构建他们的搜索引擎。</p>
</blockquote>

                                    </div>
                                    
                                            <a class="btn btn-text" href="https://blog.kingofzihua.top/post/elasticsearch-ji-ben-gai-nian">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://blog.kingofzihua.top/post/fu-wu-qi-chang-yong-duan-kou-ji-ying-yong-cheng-xu-duan-kou-zuo-yong-jie-shao">
                        服务器常用端口及应用程序端口作用介绍
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2019-09-01</time>
                    
                        <a href="https://blog.kingofzihua.top/tag/f7PDRDRNb" class="post-tag i-tag
                            i-tag-error">
            #端口
        </a>
                        
                </div>
                <div class="post-article">
                    
                        <a href="https://blog.kingofzihua.top/post/fu-wu-qi-chang-yong-duan-kou-ji-ying-yong-cheng-xu-duan-kou-zuo-yong-jie-shao" class="post-feature-image" style="background-image:url(https://blog.kingofzihua.top/post-images/fu-wu-qi-chang-yong-duan-kou-ji-ying-yong-cheng-xu-duan-kou-zuo-yong-jie-shao.png) ">
                        </a>
                        
                            <div class="post-content">
                                
                                    <div class="post-content-abstract">
                                        <blockquote>
<p>一台服务器为什么可以同时是Web服务器，也可以是FTP服务器，还可以是邮件服务器等，其中一个很重要的原因是各种服务采用不同的端口分别提供不同的服务，比如：通常TCP/IP协议规定Web采用80号端口，FTP采用21号端口等，而邮件服务器是采用25号端口。这样，通过不同端口，计算机就可以与外界进行互不干扰的通信</p>
</blockquote>

                                    </div>
                                    
                                            <a class="btn btn-text" href="https://blog.kingofzihua.top/post/fu-wu-qi-chang-yong-duan-kou-ji-ying-yong-cheng-xu-duan-kou-zuo-yong-jie-shao">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://blog.kingofzihua.top/post/tidewaysxhprof-he-xhgui-da-zao-php-fei-qin-ru-shi-jian-kong-ping-tai">
                        Tideways、xhprof 和 xhgui 打造 PHP 非侵入式监控平台
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2019-08-30</time>
                    
                        <a href="https://blog.kingofzihua.top/tag/5u6qkCj88" class="post-tag i-tag
                            i-tag-banana">
            #php
        </a>
                        
                        <a href="https://blog.kingofzihua.top/tag/aHevv4Ug4K" class="post-tag i-tag
                            i-tag-other_3">
            #监控
        </a>
                        
                </div>
                <div class="post-article">
                    
                        <a href="https://blog.kingofzihua.top/post/tidewaysxhprof-he-xhgui-da-zao-php-fei-qin-ru-shi-jian-kong-ping-tai" class="post-feature-image" style="background-image:url(https://blog.kingofzihua.top/post-images/tidewaysxhprof-he-xhgui-da-zao-php-fei-qin-ru-shi-jian-kong-ping-tai.png) ">
                        </a>
                        
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
推荐阅读

Tideways、xhprof 和 xhgui 打造 PHP 非侵入式监控平台
超全的设计模式简介（45种）
design-patterns-for-humans 中文版
MongoDB 资源、库、工具、应用程序精选列表中文版
有哪些鲜为人知，但是很有意思的网站？
一份攻城狮笔记
每天搜集 Github 上优秀的项目
一些有趣的民间故事
超好用的谷歌浏览器、Sublime Text、Phpstorm、油猴插件合集

环境准备
安装之前确保已经正确安装了以下软件

PHP
Nginx
Mongodb

安装 PHP mongodb 扩展
$ sudo pecl install mongodb

PHP 配置文件中添加
[mongodb]
extension=mongodb.so

安装 PHP tideaways 扩展
常规编译安装
$ git clone https://github.com/tideways/php-xhprof-extension.git
$ cd /path/php-xhprof-extension
$ phpize
$ ./configure
$ make
$ sudo make install

PHP 配置文件中添加
[tideways]
extension=tideways_xhprof.so
; 不需要自动加载，在程序中控制就行
tideways.auto_prepend_library=0
; 频率设置为100，在程序调用时可以修改
tideways.sample_rate=100

安装 xhgui-branch（xhgui 的汉化版）
$ git clone https://github.com/laynefyc/xhgui-branch.git
$ cd xhgui-branch
$ php install.php

修改 xhgui-branch 配置文件
&amp;lt;?php
    return array(
 	    ...
        &#39;extension&#39; =&amp;gt; &#39;tideways_xhprof&#39;,
     	...
        &#39;save.handler&#39; =&amp;gt; &#39;mongodb&#39;,
        &#39;db.host&#39; =&amp;gt; &#39;mongodb://127.0.0.1:27017&#39;,
        &#39;db.db&#39; =&amp;gt; &#39;xhprof&#39;,
 	    ...
    );

启动 mongodb 并设置 xhgui 索引，命令如下：
$ mongo
&amp;gt; use xhprof
&amp;gt; db.results.ensureIndex( { &#39;meta.SERVER.REQUEST_TIME&#39; : -1 } )
&amp;gt; db.results.ensureIndex( { &#39;profile.main().wt&#39; : -1 } )
&amp;gt; db.results.ensureIndex( { &#39;profile.main().mu&#39; : -1 } )
&amp;gt; db.results.ensureIndex( { &#39;profile.main().cpu&#39; : -1 } )
&amp;gt; db.results.ensureIndex( { &#39;meta.url&#39; : 1 } )

xhgui 本地虚拟主机配置参考
server {
    listen       80;
    server_name  xhgui.test;
    root         /Users/yaozm/Documents/wwwroot/xhgui-branch/webroot;

    # access_log  /usr/local/var/log/nginx/access.log;
    error_log  /usr/local/var/log/nginx/error.log;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
        index  index.php index.html index.htm;
    }
}

针对要分析的站点进行设置，直接在要分析站点的 nginx 配置中增加以下项，然后使配置生效就可以了。
$ fastcgi_param PHP_VALUE &amp;quot;auto_prepend_file=/path/xhgui-branch/external/header.php&amp;quot;;

参考配置
server {
    listen       80;
    server_name  laravel.test;
    root         /Users/yaozm/Documents/wwwroot/laravel/public;

    # access_log  /usr/local/var/log/nginx/access.log;
    error_log  /usr/local/var/log/nginx/error.log;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
        index  index.php index.html index.htm;
    }
 	# 添加 PHP_VALUE，告诉 PHP 程序在执行前要调用的服务
    fastcgi_param PHP_VALUE &amp;quot;auto_prepend_file=/path/wwwroot/xhgui-branch/external/header.php&amp;quot;;
}

或者也可以在修改 PHP 配置文件，告诉 PHP 程序在执行前要调用的服务
; Automatically add files before PHP document.
; http://php.net/auto-prepend-file
auto_prepend_file = &amp;quot;/path/wwwroot/xhgui-branch/external/header.php&amp;quot;



参考链接

https://github.com/phacility/xhprof
https://github.com/perftools/xhgui
https://github.com/tideways/php-xhprof-extension
https://github.com/laynefyc/xhgui-branch
https://blog.it2048.cn/article-tideways-xhgui
https://zhuanlan.zhihu.com/p/30832165


转载自 Tideways、xhprof 和 xhgui 打造 PHP 非侵入式监控平台


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://blog.kingofzihua.top/post/tidewaysxhprof-he-xhgui-da-zao-php-fei-qin-ru-shi-jian-kong-ping-tai">Read More ~</a>
                            </div>
                </div>
            </article>
            
                <!-- 翻页 -->
                
    <div class="pagination-container">
        
                
                    <a href="https://blog.kingofzihua.top/page/2" class="page-btn btn">下一页</a>
                    
    </div>
    
                </div>
                <!--  -->
                <div class="main-container-middle"></div>
                <!--  -->
                <div id="sidebar" class="main-container-right">

                    <!-- 个人信息 -->
                    
    <div class="id_card i-card">
        <div class="id_card-avatar" style="background-image: url(https://blog.kingofzihua.top/images/avatar.png?v=1577771342871)">
        </div>
        <h1 class="id_card-title">
            kingofzihua
        </h1>
        <h2 class="id_card-description">
            我未曾见过一个早起、勤奋、谨慎、诚实的人整天抱怨的 — 富兰克林
        </h2>
        <!--  -->
        <div class="id_card-sns">
            <!-- github -->
            
                <a href="https://github.com/kingofzihua" target="_blank" rel="noopener noreferrer"><i
                class="fa fa-github"></i></a>
                
                    <!-- twitter -->
                    
                            <!-- weibo -->
                            
                                    <!-- facebook -->
                                    

        </div>
    </div>
    

                        <!-- 公告栏 -->
                        
    <div class="notice-card i-card ">
        <div class="notice-title i-card-title">友情链接</div>
        <div class="notice-content">
            <p>
<a href="http://www.easyswoole.com" target="_blank" rel="noopener">easyswoole</a><br><br>
<a href="https://learnku.com/laravel" target="_blank" rel="noopener">laravel-china</a><br><br>
<a href="http://www.php20.cn" target="_blank" rel="noopener">仙士可的博客</a><br><br>
<a href="http://www.lienze.com" target="_blank" rel="noopener">随心之所</a><br><br>
<a href="https://niexp.cn" target="_blank" rel="noopener">锞锞blog</a><br><br>
<a href="http://xingdong365.com" target="_blank" rel="noopener">邢栋博客</a><br><br>
<a href="http://www.guohongfu.top" target="_blank" rel="noopener">一场、</a><br><br>
<a href="https://dzt666.cn" target="_blank" rel="noopener">dongzt</a><br><br>
<a href="http://phpcli.net" target="_blank" rel="noopener">爱因诗贤个人博客</a><br><br>
</p>
        </div>
    </div>
    

                </div>
            </div>



            <div class="site-footer">
  Powered by <a href="https://github.com/kingofzihua" target="_blank">kingofzihua</a> | 
  <a class="rss" href="https://blog.kingofzihua.top/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
</body>

</html>