<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    文本处理三剑客之awk | kingofzihua
</title>
<link rel="shortcut icon" href="https://blog.kingofzihua.top/favicon.ico?v=1577771342871">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://blog.kingofzihua.top/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://blog.kingofzihua.top/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


        
</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://blog.kingofzihua.top">
                <img class="avatar" src="https://blog.kingofzihua.top/images/avatar.png?v=1577771342871" alt="">
            </a>
            <div class="site-title">
                <h1>
                    kingofzihua
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    首页
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    归档
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    标签
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    关于
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-detail main-container">
                <!-- left -->
                <div id="content" class="main-container-left">
                    <article class="post i-card">
                        <h2 class="post-title">
                            文本处理三剑客之awk
                        </h2>
                        <div class="post-info">
                            <time class="post-time">2019-10-31</time>
                            
                        </div>
                        
                                <div class="post-content">
                                    <blockquote>
<p>AWK是一个优良的文本处理工具，Linux及Unix环境中现有的功能最强大的数据处理引擎之一。AWK 提供了极其强大的功能：可以进行样式装入、流控制、数学运算符、进程控制语句甚至于内置的变量和函数。它具备了一个完整的语言所应具有的几乎所有精美特性。              --- 百度百科</p>
</blockquote>
<!-- more -->
<h2 id="简介">简介</h2>
<p>AWK 是一个文本处理工具，通常用于处理数据并生成结果报告。</p>
<h3 id="awk的语法格式">awk的语法格式</h3>
<ul>
<li>第一种格式: <code>awk 'BEGIN{}pattern{commands}END{}' file_name</code></li>
<li>第二种格式: <code>standard output| awk 'BEGIN{}pattern{commands}END{}'</code></li>
</ul>
<h4 id="语法格式说明">语法格式说明</h4>
<table>
<thead>
<tr>
<th>语法格式</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>BEGIN{}</td>
<td>正式处理数据之前执行</td>
</tr>
<tr>
<td>pattern</td>
<td>匹配模式</td>
</tr>
<tr>
<td>{commands}</td>
<td>处理命令，可能多行</td>
</tr>
<tr>
<td>END{}</td>
<td>处理完所有匹配数据后执行</td>
</tr>
</tbody>
</table>
<h3 id="awk中的内置变量">awk中的内置变量</h3>
<table>
<thead>
<tr>
<th style="text-align:left">内置变量</th>
<th style="text-align:center"></th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$0</td>
<td style="text-align:center"></td>
<td style="text-align:left">整行内容。</td>
</tr>
<tr>
<td style="text-align:left">$1-$n</td>
<td style="text-align:center"></td>
<td style="text-align:left">当前行的第1-n个字段。</td>
</tr>
<tr>
<td style="text-align:left">NF</td>
<td style="text-align:center">Number Field</td>
<td style="text-align:left">当前行的字段个数，也就是有多少列，$NF是最后一行。</td>
</tr>
<tr>
<td style="text-align:left">NR</td>
<td style="text-align:center">Number Row</td>
<td style="text-align:left">当前行的行号，从1开始计数。</td>
</tr>
<tr>
<td style="text-align:left">FNR</td>
<td style="text-align:center">File Number Row</td>
<td style="text-align:left">多文件处理时，每个文件行号单独计数，都是从0开始。</td>
</tr>
<tr>
<td style="text-align:left">FS</td>
<td style="text-align:center">Field Separator</td>
<td style="text-align:left">输入字段分隔符，不指定默认以空格或tab键分割。</td>
</tr>
<tr>
<td style="text-align:left">RS</td>
<td style="text-align:center">Row Separator</td>
<td style="text-align:left">输入行分隔符，默认回车换行。</td>
</tr>
<tr>
<td style="text-align:left">OFS</td>
<td style="text-align:center">Output Field Separator</td>
<td style="text-align:left">输出字段分隔符，默认为空格。</td>
</tr>
<tr>
<td style="text-align:left">ORS</td>
<td style="text-align:center">Output Row Separator</td>
<td style="text-align:left">输出行分隔符，默认为回车换行。</td>
</tr>
<tr>
<td style="text-align:left">FILENAME</td>
<td style="text-align:center"></td>
<td style="text-align:left">当前输入的文件名字。</td>
</tr>
<tr>
<td style="text-align:left">ARGC</td>
<td style="text-align:center"></td>
<td style="text-align:left">命令行参数个数。</td>
</tr>
<tr>
<td style="text-align:left">ARGV</td>
<td style="text-align:center"></td>
<td style="text-align:left">命令行参数数组。</td>
</tr>
</tbody>
</table>
<h3 id="commands-处理命令">commands 处理命令</h3>
<h4 id="printf"><code>printf</code></h4>
<h5 id="格式符说明">格式符说明</h5>
<table>
<thead>
<tr>
<th style="text-align:left">格式符</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">%s</td>
<td style="text-align:left">打印字符串</td>
</tr>
<tr>
<td style="text-align:left">%d</td>
<td style="text-align:left">打印十进制数</td>
</tr>
<tr>
<td style="text-align:left">%f</td>
<td style="text-align:left">打印一个浮点数</td>
</tr>
<tr>
<td style="text-align:left">%x</td>
<td style="text-align:left">打印十六进制数</td>
</tr>
<tr>
<td style="text-align:left">%o</td>
<td style="text-align:left">打印八进制数</td>
</tr>
<tr>
<td style="text-align:left">%e</td>
<td style="text-align:left">打印数字的科学计数法形式</td>
</tr>
<tr>
<td style="text-align:left">%c</td>
<td style="text-align:left">打印单个字符的ASCII码</td>
</tr>
</tbody>
</table>
<h5 id="修饰符说明">修饰符说明</h5>
<table>
<thead>
<tr>
<th style="text-align:left">修饰符</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-</td>
<td style="text-align:left">左对齐</td>
</tr>
<tr>
<td style="text-align:left">+</td>
<td style="text-align:left">右对齐</td>
</tr>
<tr>
<td style="text-align:left">#</td>
<td style="text-align:left">显示8进制在前面加0，显示16进制在前面加0x。</td>
</tr>
</tbody>
</table>
<h3 id="正则表达式于操作符">正则表达式于操作符</h3>
<p>awk同sed一样也可以通过模式匹配来对输入的文本进行匹配处理。awk也支持大量的正则表达式模式，大部分与sed支持的元字符类似，而且正则表达式是玩转三剑客的必备工具。</p>
<h4 id="awk支持的正则表达式元字符">awk支持的正则表达式元字符</h4>
<table>
<thead>
<tr>
<th style="text-align:left">元字符</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">示例</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">^</td>
<td style="text-align:left">字符串开头</td>
<td style="text-align:left">/^creditease/</td>
<td style="text-align:left">匹配所有以 creditease 开头的字符串</td>
</tr>
<tr>
<td style="text-align:left">$</td>
<td style="text-align:left">字符串的结尾</td>
<td style="text-align:left">/creditease$/</td>
<td style="text-align:left">匹配所有以 creditease 结尾的字符串</td>
</tr>
<tr>
<td style="text-align:left">.</td>
<td style="text-align:left">匹配任意单个字符(包括回车符)</td>
<td style="text-align:left">/c..1/</td>
<td style="text-align:left">匹配字母c，然后两个任意字符,再以1结尾的行， 比如ckkl</td>
</tr>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">重复0个或多个字符</td>
<td style="text-align:left">/a*cool/</td>
<td style="text-align:left">匹配a 和cool 中间间隔0个或多个字符</td>
</tr>
<tr>
<td style="text-align:left">+</td>
<td style="text-align:left">重复前一个字符一次或一次以上</td>
<td style="text-align:left">/a+b/</td>
<td style="text-align:left">匹配一个或多个a加b的行</td>
</tr>
<tr>
<td style="text-align:left">?</td>
<td style="text-align:left">匹配0个或一个前导字符</td>
<td style="text-align:left">/a?b/</td>
<td style="text-align:left">匹配b或者ab的行</td>
</tr>
<tr>
<td style="text-align:left">[]</td>
<td style="text-align:left">匹配指定字符组内的任一个字符</td>
<td style="text-align:left">/^[abc]/</td>
<td style="text-align:left">匹配以字母a或b或c开头的行</td>
</tr>
<tr>
<td style="text-align:left">[^]</td>
<td style="text-align:left">匹配不再指定字符组内的任一个字符</td>
<td style="text-align:left">/<sup>[</sup>abc]/</td>
<td style="text-align:left">匹配不以字母a或b或c开头的行</td>
</tr>
<tr>
<td style="text-align:left">()</td>
<td style="text-align:left">子表达式组合</td>
<td style="text-align:left">/(cool)+/</td>
<td style="text-align:left">表示一个或多个cool组合，当有一些字符需要组合时，使用括号括起来</td>
</tr>
<tr>
<td style="text-align:left">|</td>
<td style="text-align:left">或者的意思</td>
<td style="text-align:left">/(cool)|B/</td>
<td style="text-align:left">匹配cool或者字母B的行</td>
</tr>
</tbody>
</table>

                                </div>
                    </article>
                    <!--  -->
                    
                        <div class="next-post">
                            <div class="next">下一篇</div>
                            <a href="https://blog.kingofzihua.top/post/elasticsearch-query-dsl-compound-queries">
                                <h3 class="post-title">
                                    Elasticsearch Query DSL - 复合查询
                                </h3>
                            </a>
                        </div>
                        
                            <div id="disqus_thread"></div>
                            <div id="gitalk-container"></div>
                </div>
                <!-- middle -->
                <div class="main-container-middle"></div>
                <!-- right -->
                <div id="sidebar" class="main-container-right">
                    
                        <!-- toc -->
                        
    <div class="toc-card i-card ">
        <div class="toc-title i-card-title">目录</div>
        <div class="toc-content">
            <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E7%AE%80%E4%BB%8B">简介</a>
<ul>
<li><a href="#awk%E7%9A%84%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F">awk的语法格式</a>
<ul>
<li><a href="#%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F%E8%AF%B4%E6%98%8E">语法格式说明</a></li>
</ul>
</li>
<li><a href="#awk%E4%B8%AD%E7%9A%84%E5%86%85%E7%BD%AE%E5%8F%98%E9%87%8F">awk中的内置变量</a></li>
<li><a href="#commands-%E5%A4%84%E7%90%86%E5%91%BD%E4%BB%A4">commands 处理命令</a>
<ul>
<li><a href="#printf"><code>printf</code></a>
<ul>
<li><a href="#%E6%A0%BC%E5%BC%8F%E7%AC%A6%E8%AF%B4%E6%98%8E">格式符说明</a></li>
<li><a href="#%E4%BF%AE%E9%A5%B0%E7%AC%A6%E8%AF%B4%E6%98%8E">修饰符说明</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%BA%8E%E6%93%8D%E4%BD%9C%E7%AC%A6">正则表达式于操作符</a>
<ul>
<li><a href="#awk%E6%94%AF%E6%8C%81%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%83%E5%AD%97%E7%AC%A6">awk支持的正则表达式元字符</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
        <script>
            function locateCatelogList() {
                /*获取文章目录集合,可通过:header过滤器*/
                var alis = $('.post-content :header');
                /*获取侧边栏目录列表集合**/
                var sidebar_alis = $('.markdownIt-TOC a');
                /*获取滚动条到顶部的距离*/
                var scroll_height = $(window).scrollTop();
                for (var i = 0; i < alis.length; i++) {
                    /*获取锚点集合中的元素分别到顶点的距离*/
                    var a_height = $(alis[i]).offset().top;
                    if (a_height < scroll_height) {
                        /*高亮显示*/
                        sidebar_alis.removeClass('on');
                        $(sidebar_alis[i]).addClass('on');
                    }
                }
            }
            $(function() {
                /*绑定滚动事件 */
                $(window).bind('scroll', locateCatelogList);
            });
        </script>
    </div>
    
                            

                </div>




            </div>


            <div class="site-footer">
  Powered by <a href="https://github.com/kingofzihua" target="_blank">kingofzihua</a> | 
  <a class="rss" href="https://blog.kingofzihua.top/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>


    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
    
</body>

</html>